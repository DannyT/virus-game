<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tilemap test</title>
    <script src="phaser/phaser.js"></script>
</head>
<body>
    <script>
    var config = {
        backgroundColor: 0xffffff,
        width: 800,
        height: 640,
        physics: {
            default: 'arcade'
        },
        type: Phaser.AUTO,
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);
    
    function preload ()
    {
        this.load.image('cow', 'assets/cow.png');
    }

    function create ()
    {
        // TODO: refactor (json? method with params? array?)
        var path = new Phaser.Curves.Path(300, 200)
            .lineTo(200, 200)
            .lineTo(300, 200)
            .lineTo(300, 100)
            .lineTo(300, 200)
            .lineTo(400, 200)
            .lineTo(300, 200)
            .lineTo(300, 300)
            .lineTo(300, 200);

        var path2 = new Phaser.Curves.Path(300, 200)
            .lineTo(230, 120)
            .lineTo(300, 200)
            .lineTo(370, 120)
            .lineTo(300, 200)
            .lineTo(370, 270)
            .lineTo(300, 200);

        var graphics = this.add.graphics();

        graphics.lineStyle(1, 0x000000, 1);
        path.draw(graphics, 0);
        

        graphics.lineStyle(1, 0xff0000, 1);
        path2.draw(graphics, 0);

        var cow = this.add.follower(path, 0, 0, 'cow');
        var current = 0;
        cow.startFollow({
            positionOnPath: true,
            duration: 6000,
            yoyo: false,
            rotateToPath: false,
            verticalAdjust: false,
            onComplete: () => {
                if(current == 0)
                {
                    cow.setPath(path2);
                    current ++;
                }
                else
                {
                    cow.setPath(path);
                    current--;
                }
            }
        });
    }
    
    function update()
    {
        
    }

    </script>
    
</body>
</html>